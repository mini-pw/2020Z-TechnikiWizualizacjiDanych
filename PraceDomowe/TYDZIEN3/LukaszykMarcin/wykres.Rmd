---
title: 'Techniki wizualizacji danych - praca domowa nr 2'
author: "Marcin Lukaszyk"
date: "20 X 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

## Dane do wykresu

Wykres przedstawia wyniki jednej z ankiet bdcej czci badania przeprowadzonego w 17 krajach przez Pew Research Center, pt. _European Public Opinion Three Decades After the Fall of Communism_ (pl. Europejska opinia publiczna trzy dekady po upadku komunizmu). Raport obejmuje opinie spoeczestwa na temat m.in. wartoci demokratycznych, grup mniejszociowych, Unii Europejskiej i r贸wnoci pci.

Wybrane do pracy domowej zapytanie brzmi: _kt贸ry rodzaj ma偶estwa uznajesz za lepszy spos贸b 偶ycia?_ Wykres przedstawia procent zapytanych w ka偶dym kraju, kt贸rzy udzielili odpowiedzi "tradycyjne" lub "egalitarne".

Oryginalne wyniki s dostpne pod tym adresem: https://www.pewresearch.org/global/2019/10/14/gender-equality-2/pg_10-15-19-europe-values-07-06/, a cz artykuu z tym wykresem mo偶na przeczyta tutaj: https://www.pewresearch.org/global/2019/10/14/gender-equality-2/

```{r read}
dane <- readRDS("dane.rds")
dane$kraj <- factor(dane$kraj, levels=rev(unique(as.character(dane$kraj))))
  # edycja czynnik贸w konieczna dla zachowania oyginalnej kolejnoci
dane[dane$odp=="a", "proc"] <- dane[dane$odp=="a", "proc"]*(-1)
dane<-dane[order(dane$proc,decreasing = TRUE),]
df<-dane[!(dane$proc < 0 ),] #stworzenie ramki ktra ma tylko warotsci egalitarne 
dane$kraj <- factor(dane$kraj, levels = dane$kraj[order(df$proc)]) #na podstaiwe tej ramki wyznaczylem factor levele kazdego kraju tak by byly kolejno
#od egalitarnego do najmniej egalitarnego


```

Wartoci odpowiedzi na jeden z wariant贸w, oznaczonych w pliku RDS jako "a", zostay lekko zmodyfikowane w celu skierowania ich na wykresie w przeciwnym kierunku wzgldem tych drugich.

## Wykres

```{r graph}
ggplot(data=dane, aes(x=kraj, y=proc, fill=odp, label=paste(abs(proc), "%", sep=""))) +
  geom_col(width = 0.75) +
  geom_text(color="white", size=4, hjust="inward") +
  scale_fill_manual(values=c("#000080", "#008000"),
                    name="",
                    labels=c("TRADYCYJNE\n\n(m偶 pracuje, a 偶ona \nopiekuje si domem)", "EGALITARNE\n\n(m偶 i 偶ona obydwoje pracuj \ni opiekuj si domem)")) +
  theme(legend.position = "top",    
    panel.grid.major = element_line(colour = "#757575"),
    panel.grid.minor = element_blank(),#wyczyszczenie tla wykresu
    panel.background = element_blank()
                                  ) +
  labs(y = "Procent pytanych osob zgadzajacych sie z dana opinia", 
       subtitle="Kt贸ry rodzaj ma偶estwa uznajesz za lepszy spos贸b 偶ycia?",
       x = "Kraj respondentow") + #zmienilem nazwy osi na odpowiedniejsze
  coord_flip() +
  scale_y_continuous(name = "Procent pytanych osob zgadzajacych sie z dana opinia",breaks = c(),labels = c())
# wyrzucilem skale bo mamy wartosci numeryczne dla kazdego rekordu
```
